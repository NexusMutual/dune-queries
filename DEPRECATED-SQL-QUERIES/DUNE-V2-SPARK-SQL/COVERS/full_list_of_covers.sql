WITH
  v1_product_info as (
    SELECT
      '0xF5DCe57282A584D2746FaF1593d3121Fcac444dC' as scAdd,
      'Compound Sai' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x8B3d70d628Ebd30D4A2ea82DB95bA2e906c71633' as scAdd,
      'bZx v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5504a1d88005236147EC86C62cfb53043bD1276a' as scAdd,
      'Unknown' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x4Ddc2D193948926D02f9B1fE9e1daa0718270ED5' as scAdd,
      'Compound ETH' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x080bf510FCbF18b91105470639e9561022937712' as scAdd,
      '0x v2.1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x16de59092dAE5CcF4A1E6439D611fd0653f0Bd01' as scAdd,
      'iearn yDAI v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xAF350211414C5DC176421Ea05423F0cC494261fB' as scAdd,
      'Saturn DAO Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5d3a536E4D6DbD6114cc1Ead35777bAB948E3643' as scAdd,
      'Compound DAI' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x2157A7894439191e520825fe9399aB8655E0f708' as scAdd,
      'Uniswap Exchange Template' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x9f8F72aA9304c8B593d555F12eF6589cC3A579A2' as scAdd,
      'Maker Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x6e95C8E8557AbC08b46F3c347bA06F8dC012763f' as scAdd,
      'Legacy Gnosis MultiSig' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xb1CD6e4153B2a390Cf00A6556b0fC1458C4A5533' as scAdd,
      'Bancor ETHBNT Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x29fe7D60DdF151E5b52e5FAB4f1325da6b2bD958' as scAdd,
      'Pool Together DAI' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x4a57E687b9126435a9B19E4A802113e266AdeBde' as scAdd,
      'Flexacoin Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x519b70055af55A007110B4Ff99b0eA33071c720a' as scAdd,
      'dxDAO' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x802275979B020F0ec871c5eC1db6e412b72fF20b' as scAdd,
      'Nuo' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xb7896fce748396EcFC240F5a0d3Cc92ca42D7d84' as scAdd,
      'Pool Together SAI' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x932773aE4B661029704e731722CF8129e1B32494' as scAdd,
      'Pool Together v2' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xB1dD690Cc9AF7BB1a906A9B5A94F94191cc553Ce' as scAdd,
      'Argent' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x2b591e99afE9f32eAA6214f7B7629768c40Eeb39' as scAdd,
      'Hex Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x2C4Bd064b998838076fa341A83d007FC2FA50957' as scAdd,
      'Uniswap v1 MKR Pool' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x364508A5cA0538d8119D3BF40A284635686C98c4' as scAdd,
      'dydx Perpetual' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x6B175474E89094C44Da98b954EedeAC495271d0F' as scAdd,
      'DAI Token' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xD5D2b9e9bcd172D5fC8521AFd2C98Dd239F5b607' as scAdd,
      'Unknown' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x241e82C79452F51fbfc89Fac6d912e021dB1a3B7' as scAdd,
      'DDEX' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x12D66f87A04A9E220743712cE6d9bB1B5616B8Fc' as scAdd,
      'Tornado Cash' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5d22045DAcEAB03B158031eCB7D9d06Fad24609b' as scAdd,
      'Deversifi' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x498b3BfaBE9F73db90D252bCD4Fa9548Cd0Fd981' as scAdd,
      'Instadapp Registry' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x448a5065aeBB8E423F0896E6c5D525C040f59af3' as scAdd,
      'Maker SCD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xe80d347DF1209a76DD9d2319d62912ba98C54DDD' as scAdd,
      'RenVM' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xB27F1DB0a7e473304A5a06E54bdf035F671400C0' as scAdd,
      '0x v3' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x1E0447b19BB6EcFdAe1e4AE1694b0C3659614e4e' as scAdd,
      'dydx Margin' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3d9819210A31b4961b30EF54bE2aeD79B9c9Cd3B' as scAdd,
      'Compound v2' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x34CfAC646f301356fAa8B21e94227e3583Fe3F5F' as scAdd,
      'Gnosis Safe' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc0a47dFe034B400B47bDaD5FecDa2621de6c4d95' as scAdd,
      'Uniswap v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x35D1b3F3D7966A1DFe207aa4514C12a259A0492B' as scAdd,
      'MakerDAO MCD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x72338b82800400F5488eCa2B5A37270ba3B7A111' as scAdd,
      'Paraswap - OLD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc1D2819CE78f3E15Ee69c6738eB1B400A26e632A' as scAdd,
      'Aave v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x10eC0D497824e342bCB0EDcE00959142aAa766dD' as scAdd,
      'Idle Finance - OLD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3' as scAdd,
      'Aave Lending Core' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x45F783CCE6B7FF23B2ab2D70e416cdb7D6055f51' as scAdd,
      'Curve fi - OLD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x11111254369792b2Ca5d084aB5eEA397cA8fa48B' as scAdd,
      '1Inch (DEX & Liquidity Pools)' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xF92C1ad75005E6436B4EE84e88cB23Ed8A290988' as scAdd,
      'Paraswap OLD' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xb529964F86fbf99a6aA67f72a27e59fA3fa4FEaC' as scAdd,
      'Opyn' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x9D25057e62939D3408406975aD75Ffe834DA4cDd' as scAdd,
      'Yearn Finance (all vaults)' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x77208a6000691E440026bEd1b178EF4661D37426' as scAdd,
      'Totle' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x12f208476F64De6e6f933E55069Ba9596D818e08' as scAdd,
      'Flexa Staking' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x78751B12Da02728F467A44eAc40F5cbc16Bd7934' as scAdd,
      'Idle v3' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x7fC77b5c7614E1533320Ea6DDc2Eb61fa00A9714' as scAdd,
      'Curve BTC Pools' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x79a8C46DeA5aDa233ABaFFD40F3A0A2B1e5A4F27' as scAdd,
      'Curve All Pools (incl staking)' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5B67871C3a857dE81A1ca0f9F7945e5670D986Dc' as scAdd,
      'Set Protocol' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f' as scAdd,
      'Uniswap v2' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x9424B1412450D0f8Fc2255FAf6046b98213B76Bd' as scAdd,
      'Balancer v1' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xD36132E0c1141B26E62733e018f12Eb38A7b7678' as scAdd,
      'Ampleforth Tokengeyser' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x86969d29F5fd327E1009bA66072BE22DB6017cC6' as scAdd,
      'Paraswap v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5f9AE054C7F0489888B1ea46824b4B9618f8A711' as scAdd,
      'Melon v1' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x1fd169A4f5c59ACf79d0Fd5d91D1201EF1Bce9f1' as scAdd,
      'MolochDAO' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xAFcE80b19A8cE13DEc0739a1aaB7A028d6845Eb3' as scAdd,
      'mStable' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC011a73ee8576Fb46F5E1c5751cA3B9Fe0af2a6F' as scAdd,
      'Synthetix' as name,
      'protocol' as type,
      '2020-06-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x2a0c0DBEcC7E4D658f48E01e3fA353F44050c208' as scAdd,
      'IDEX v1' as name,
      'protocol' as type,
      '2020-01-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x9AAb3f75489902f3a48495025729a0AF77d4b11e' as scAdd,
      'Kyber (Katalyst)' as name,
      'protocol' as type,
      '2020-07-07' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x1F573D6Fb3F13d689FF844B4cE37794d79a7FF1C' as scAdd,
      'Bancor v2' as name,
      'protocol' as type,
      '2020-07-23' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3e532e6222afe9Bcf02DCB87216802c75D5113aE' as scAdd,
      'UMA' as name,
      'protocol' as type,
      '2020-07-30' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x02285AcaafEB533e03A7306C55EC031297df9224' as scAdd,
      'dForce Yield Market' as name,
      'protocol' as type,
      '2020-08-13' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0e2298E3B3390e3b945a5456fBf59eCc3f55DA16' as scAdd,
      'Yam Finance v1' as name,
      'protocol' as type,
      '2020-08-13' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3fE7940616e5Bc47b0775a0dccf6237893353bB4' as scAdd,
      'Idle v4' as name,
      'protocol' as type,
      '2020-08-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x71CD6666064C3A1354a3B4dca5fA1E2D3ee7D303' as scAdd,
      'Mooniswap' as name,
      'protocol' as type,
      '2020-08-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xe20A5C79b39bC8C363f0f49ADcFa82C2a01ab64a' as scAdd,
      'tBTC Contracts v1' as name,
      'protocol' as type,
      '2020-09-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xe9778E69a961e64d3cdBB34CF6778281d34667c2' as scAdd,
      'NuCypher Worklock' as name,
      'protocol' as type,
      '2020-09-29' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x4C39b37f5F20a0695BFDC59cf10bd85a6c4B7c30' as scAdd,
      'Akropolis Delphi' as name,
      'protocol' as type,
      '2020-10-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3A97247DF274a17C59A3bd12735ea3FcDFb49950' as scAdd,
      'DODO Exchange' as name,
      'protocol' as type,
      '2020-10-19' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x26aaD4D82f6c9FA6E34D8c1067429C986A055872' as scAdd,
      'CoFix' as name,
      'protocol' as type,
      '2020-10-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xCB876f60399897db24058b2d58D0B9f713175eeF' as scAdd,
      'Pool Together v3' as name,
      'protocol' as type,
      '2020-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xa4c8d221d8BB851f83aadd0223a8900A6921A349' as scAdd,
      'Set Protocol v2' as name,
      'protocol' as type,
      '2020-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xB94199866Fe06B535d019C11247D3f921460b91A' as scAdd,
      'Yield Protocol' as name,
      'protocol' as type,
      '2020-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x00000000219ab540356cBB839Cbe05303d7705Fa' as scAdd,
      'Eth 2.0 (deposit contract)' as name,
      'protocol' as type,
      '2020-11-06' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x878F15ffC8b894A1BA7647c7176E4C01f74e140b' as scAdd,
      'Hegic' as name,
      'protocol' as type,
      '2020-11-09' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xfA5047c9c78B8877af97BDcb85Db743fD7313d4a' as scAdd,
      'Keeper DAO' as name,
      'protocol' as type,
      '2020-11-19' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3d5BC3c8d13dcB8bF317092d84783c2697AE9258' as scAdd,
      'CREAM v1' as name,
      'protocol' as type,
      '2020-11-24' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x7a9701453249e84fd0D5AfE5951e9cBe9ed2E90f' as scAdd,
      'TrueFi' as name,
      'protocol' as type,
      '2020-11-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x67B66C99D3Eb37Fa76Aa3Ed1ff33E8e39F0b9c7A' as scAdd,
      'Alpha Homora v1' as name,
      'protocol' as type,
      '2020-11-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x7d2768dE32b0b80b7a3454c06BdAc94A69DDc7A9' as scAdd,
      'Aave v2' as name,
      'protocol' as type,
      '2020-12-03' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc2EdaD668740f1aA35E4D8f227fB8E17dcA888Cd' as scAdd,
      'SushiSwap v1' as name,
      'protocol' as type,
      '2020-12-09' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xedfC81Bf63527337cD2193925f9C0cF2D537AccA' as scAdd,
      'Cover Protocol v1' as name,
      'protocol' as type,
      '2020-12-11' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xA51156F3F1e39d1036Ca4ba4974107A1C1815d1e' as scAdd,
      'Perpetual Protocol' as name,
      'protocol' as type,
      '2020-12-17' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x6354E79F21B56C11f48bcD7c451BE456D7102A36' as scAdd,
      'BadgerDAO' as name,
      'protocol' as type,
      '2020-12-29' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x9abd0b8868546105F6F48298eaDC1D9c82f7f683' as scAdd,
      'Notional Finance v1' as name,
      'protocol' as type,
      '2021-01-18' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xE75D77B1865Ae93c7eaa3040B038D7aA7BC02F70' as scAdd,
      'Origin Dollar' as name,
      'protocol' as type,
      '2021-01-22' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x7C06792Af1632E77cb27a558Dc0885338F4Bdf8E' as scAdd,
      'Opyn v2' as name,
      'protocol' as type,
      '2021-02-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xCC88a9d330da1133Df3A7bD823B95e52511A6962' as scAdd,
      'Reflexer' as name,
      'protocol' as type,
      '2021-03-04' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xa4F1671d3Aee73C05b552d57f2d16d3cfcBd0217' as scAdd,
      'Vesper' as name,
      'protocol' as type,
      '2021-03-10' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5D9972dD3Ba5602574ABeA6bF9E1713568D49903' as scAdd,
      'Benchmark Protocol' as name,
      'protocol' as type,
      '2021-03-22' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xB17640796e4c27a39AF51887aff3F8DC0daF9567' as scAdd,
      'Stake DAO' as name,
      'protocol' as type,
      '2021-03-29' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xA39739EF8b0231DbFA0DcdA07d7e29faAbCf4bb2' as scAdd,
      'Liquity' as name,
      'protocol' as type,
      '2021-04-05' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x284D7200a0Dabb05ee6De698da10d00df164f61d' as scAdd,
      'Harvest Finance' as name,
      'protocol' as type,
      '2021-04-16' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x1F98431c8aD98523631AE4a59f267346ea31F984' as scAdd,
      'Uniswap v3' as name,
      'protocol' as type,
      '2021-05-05' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x4B8d90D68F26DEF303Dcb6CFc9b63A1aAEC15840' as scAdd,
      'Barnbridge Smart Yield v1' as name,
      'protocol' as type,
      '2021-06-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xF403C135812408BFbE8713b5A23a04b3D48AAE31' as scAdd,
      'Convex Finance v1' as name,
      'protocol' as type,
      '2021-06-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc21D353FF4ee73C572425697f4F5aaD2109fe35b' as scAdd,
      'Alchemix v1' as name,
      'protocol' as type,
      '2021-06-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x99c666810bA4Bf9a4C2318CE60Cb2c279Ee2cF56' as scAdd,
      'Homora v2' as name,
      'protocol' as type,
      '2021-06-23' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xBA12222222228d8Ba445958a75a0704d566BF2C8' as scAdd,
      'Balancer v2' as name,
      'protocol' as type,
      '2021-08-04' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xA625AB01B08ce023B2a342Dbb12a16f2C8489A8F' as scAdd,
      'Alpaca Finance' as name,
      'protocol' as type,
      '2021-08-13' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x08FB62c84909dA3Aa5F59E01763E5FDC62De76e9' as scAdd,
      'Gamma Strategies' as name,
      'protocol' as type,
      '2021-08-20' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x8481a6EbAf5c7DABc3F7e09e44A89531fd31F822' as scAdd,
      'Goldfinch' as name,
      'protocol' as type,
      '2021-09-24' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57D000000000000000000000000000000000001' as scAdd,
      'Celsius' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57D000000000000000000000000000000000002' as scAdd,
      'BlockFi' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57d000000000000000000000000000000000003' as scAdd,
      'Nexo' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57d000000000000000000000000000000000004' as scAdd,
      'inLock' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57D000000000000000000000000000000000005' as scAdd,
      'Ledn' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57d000000000000000000000000000000000006' as scAdd,
      'Hodlnaut' as name,
      'custodian' as type,
      '2020-12-02' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57d000000000000000000000000000000000007' as scAdd,
      'Binance' as name,
      'custodian' as type,
      '2021-01-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57D000000000000000000000000000000000008' as scAdd,
      'Coinbase' as name,
      'custodian' as type,
      '2021-01-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57d000000000000000000000000000000000009' as scAdd,
      'Kraken' as name,
      'custodian' as type,
      '2021-01-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57d000000000000000000000000000000000010' as scAdd,
      'Gemini' as name,
      'custodian' as type,
      '2021-01-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57d000000000000000000000000000000000011' as scAdd,
      'FTX' as name,
      'custodian' as type,
      '2021-05-04' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xC57d000000000000000000000000000000000012' as scAdd,
      'Crypto.com' as name,
      'custodian' as type,
      '2021-07-06' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xc57d000000000000000000000000000000000013' as scAdd,
      'Yield.app' as name,
      'custodian' as type,
      '2021-07-06' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xefa94DE7a4656D787667C749f7E1223D71E9FD88' as scAdd,
      'Pangolin' as name,
      'protocol' as type,
      '2021-10-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0CED6166873038Ac0cc688e7E6d19E2cBE251Bf0' as scAdd,
      'Centrifuge Tinlake' as name,
      'protocol' as type,
      '2021-10-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x835482FE0532f169024d5E9410199369aAD5C77E' as scAdd,
      'Rari Capital' as name,
      'protocol' as type,
      '2021-10-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xd96f48665a1410C0cd669A88898ecA36B9Fc2cce' as scAdd,
      'Abracadabra' as name,
      'protocol' as type,
      '2021-11-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x48D49466CB2EFbF05FaA5fa5E69f2984eDC8d1D7' as scAdd,
      'Premia Finance' as name,
      'protocol' as type,
      '2021-11-04' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000001' as scAdd,
      'Anchor' as name,
      'protocol' as type,
      '2021-04-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000002' as scAdd,
      'Bunny' as name,
      'protocol' as type,
      '2021-04-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000003' as scAdd,
      'Venus' as name,
      'protocol' as type,
      '2021-04-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000004' as scAdd,
      'Thorchain' as name,
      'protocol' as type,
      '2021-04-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000005' as scAdd,
      'Pancakeswap v1' as name,
      'protocol' as type,
      '2021-04-26' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000006' as scAdd,
      'Yearn yvDAI v2' as name,
      'token' as type,
      '2021-05-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000007' as scAdd,
      'Yearn yvUSDC v2' as name,
      'token' as type,
      '2021-05-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000008' as scAdd,
      'Yearn ycrvstETH v2' as name,
      'token' as type,
      '2021-05-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000009' as scAdd,
      'Curve 3pool LP (3Crv)' as name,
      'token' as type,
      '2021-05-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000010' as scAdd,
      'Curve sETH LP (eCrv)' as name,
      'token' as type,
      '2021-05-25' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000011' as scAdd,
      'Idle DAI v4 (idleDAIYield)' as name,
      'token' as type,
      '2021-07-05' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000012' as scAdd,
      'Idle USDT v4 (idleUSDTYield)' as name,
      'token' as type,
      '2021-07-05' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000013' as scAdd,
      'Convex stethCrv (cvxstethCrv)' as name,
      'token' as type,
      '2021-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000014' as scAdd,
      'Convex 3CRV (cvx3CRV)' as name,
      'token' as type,
      '2021-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000015' as scAdd,
      'Convex mimCrv (cvxmimCrv)' as name,
      'token' as type,
      '2021-10-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xaE7b92C8B14E7bdB523408aE0A6fFbf3f589adD9' as scAdd,
      'Popsicle Finance' as name,
      'protocol' as type,
      '2021-11-10' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x1344A36A1B56144C3Bc62E7757377D288fDE0369' as scAdd,
      'Notional Finance v2' as name,
      'protocol' as type,
      '2021-11-22' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x575409F8d77c12B05feD8B455815f0e54797381c' as scAdd,
      'OlympusDAO' as name,
      'protocol' as type,
      '2021-11-29' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x25751853Eab4D0eB3652B5eB6ecB102A2789644B' as scAdd,
      'Ribbon Finance v2' as name,
      'protocol' as type,
      '2021-12-06' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xd89a09084555a7D0ABe7B111b1f78DFEdDd638Be' as scAdd,
      'Pool Together v4' as name,
      'protocol' as type,
      '2021-12-09' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x60aE616a2155Ee3d9A68541Ba4544862310933d4' as scAdd,
      'Trader Joe' as name,
      'protocol' as type,
      '2021-12-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000016' as scAdd,
      'Origin OUSD' as name,
      'token' as type,
      '2022-01-24' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x2BB8de958134AFd7543d4063CaFAD0b7c6de08BC' as scAdd,
      'Ondo' as name,
      'protocol' as type,
      '2022-01-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x7e6d3b1161DF9c9c7527F68d651B297d2Fdb820B' as scAdd,
      'Enzyme v3' as name,
      'protocol' as type,
      '2022-02-16' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x453D4Ba9a2D594314DF88564248497F7D74d6b2C' as scAdd,
      'Beefy' as name,
      'protocol' as type,
      '2022-03-04' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0xfdA462548Ce04282f4B6D6619823a7C64Fdc0185' as scAdd,
      'Angle' as name,
      'protocol' as type,
      '2022-03-08' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x66357dCaCe80431aee0A7507e2E361B7e2402370' as scAdd,
      'Platypus' as name,
      'protocol' as type,
      '2022-03-18' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000017' as scAdd,
      'FODL' as name,
      'protocol' as type,
      '2022-03-24' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x5C6374a2ac4EBC38DeA0Fc1F8716e5Ea1AdD94dd' as scAdd,
      'Alchemix v2' as name,
      'protocol' as type,
      '2022-03-24' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000018' as scAdd,
      'Bundle: Gelt + mStable + Aave v2' as name,
      'protocol' as type,
      '2022-04-14' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000019' as scAdd,
      'Yeti Finance' as name,
      'protocol' as type,
      '2022-04-28' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000020' as scAdd,
      'Babylon Finance' as name,
      'protocol' as type,
      '2022-05-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000021' as scAdd,
      'Vector' as name,
      'protocol' as type,
      '2022-05-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000022' as scAdd,
      'Bancor v3' as name,
      'protocol' as type,
      '2022-05-12' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000023' as scAdd,
      'Ease' as name,
      'protocol' as type,
      '2022-05-31' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000024' as scAdd,
      'Iron Bank' as name,
      'protocol' as type,
      '2022-06-08' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000025' as scAdd,
      'Stakewise operated (3 ETH / validator)' as name,
      'eth2slashing' as type,
      '2022-06-08' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000026' as scAdd,
      'Stakewise 3rd party (3 ETH / validator)' as name,
      'eth2slashing' as type,
      '2022-06-08' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000027' as scAdd,
      'Nested' as name,
      'protocol' as type,
      '2022-07-05' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000028' as scAdd,
      'Euler' as name,
      'protocol' as type,
      '2022-08-29' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x3D6bA331e3D9702C5e8A8d254e5d8a285F223aba' as scAdd,
      'GMX' as name,
      'protocol' as type,
      '2022-09-01' as date_added,
      'v1' as syndicate
    UNION ALL
    SELECT
      '0x0000000000000000000000000000000000000029' as scAdd,
      'Sherlock' as name,
      'sherlock' as type,
      '2022-10-17' as date_added,
      'v1' as syndicate
  ),
  covers_details_event as (
    select
      cid as cover_id,
      date_trunc('minute', evt_block_time) as start_time,
      date '1970-01-01 00:00:00' + concat(expiry, ' second'):: interval as end_time,
      scAdd as productContract,
      sumAssured as sum_assured,
      case
        when curr = '0x45544800' then 'ETH'
        when curr = '0x44414900' then 'DAI'
      end as cover_asset,
      premiumNXM * 1E-18 as premiumNxm,
      premium * 1E-18 as premium,
      evt_tx_hash as evt_hash
    from
      nexusmutual_ethereum.QuotationData_evt_CoverDetailsEvent
  ),
  cover_product_info as (
    SELECT
      cover_id,
      start_time,
      date_trunc('day', start_time) as start_time_trunc,
      date_trunc('minute', end_time) as end_time,
      sum_assured,
      cover_asset,
      premiumNxm,
      premium,
      evt_hash,
      Coalesce(
        v1_product_info.scAdd,
        covers_details_event.productContract
      ) as product_address,
      syndicate,
      name as product_name,
      type as product_type
    from
      covers_details_event
      LEFT JOIN v1_product_info ON v1_product_info.scAdd = covers_details_event.productContract
  ),
  covers as (
    select
      _userAddress as user_address,
      call_tx_hash as call_tx
    from
      nexusmutual_ethereum.QuotationData_call_addCover
    where
      call_success = true
  ),
  day_prices as (
    SELECT
      DISTINCT date_trunc('day', minute) AS day,
      symbol,
      AVG(price) OVER (
        PARTITION BY
          date_trunc('day', minute),
          symbol
      ) AS price_dollar
    FROM
      prices.usd
    WHERE
      (
        symbol = 'DAI'
        OR symbol = 'ETH'
      )
      AND minute > '2019-01-01 00:00:00':: TIMESTAMP
  ),
  average_eth_day_prices AS (
    SELECT
      day,
      price_dollar as eth_price_dollar
    FROM
      day_prices
    WHERE
      symbol = 'ETH'
  ),
  average_dai_day_prices AS (
    SELECT
      day,
      price_dollar as dai_price_dollar
    FROM
      day_prices
    WHERE
      symbol = 'DAI'
  )
SELECT
  cover_id,
  cover_asset,
  sum_assured,
  dai_price_dollar,
  eth_price_dollar,
  CASE
    WHEN cover_asset = 'ETH' THEN sum_assured * eth_price_dollar
    WHEN cover_asset = 'DAI' THEN sum_assured * dai_price_dollar
  END as dollar_value,
  CASE
    WHEN cover_asset = 'ETH' THEN sum_assured
    WHEN cover_asset = 'DAI' THEN (sum_assured * dai_price_dollar) / eth_price_dollar
  END as eth_value,
  premiumNxm,
  premium,
  syndicate,
  product_type,
  product_name,
  start_time,
  -- TO_CHAR(start_time, 'mon') as start_month,
  end_time,
  user_address,
  end_time - start_time as period,
  CASE
    when end_time >= NOW() then 'Active'
    when end_time < NOW() then 'Expired'
  END AS active,
  COUNT(user_address) OVER (
    PARTITION BY
      user_address
    ORDER BY
      start_time
  ) AS rank_no_of_purchase,
  call_tx
FROM
  cover_product_info
  LEFT JOIN average_eth_day_prices ON cover_product_info.start_time_trunc = average_eth_day_prices.day
  LEFT JOIN average_dai_day_prices ON cover_product_info.start_time_trunc = average_dai_day_prices.day
  LEFT JOIN covers ON cover_product_info.evt_hash = covers.call_tx
ORDER BY
  start_time DESC

  